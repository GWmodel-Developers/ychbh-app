<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>黄柏河流域综合执法信息管理系统</title>
<link rel="stylesheet" href="../jquery.mobile-1.4.5/jquery.mobile-1.4.5.css">
<script src="../jquery.mobile-1.4.5/jquery-2.1.4.min.js"></script>
<script src="../jquery.mobile-1.4.5/jquery.mobile-1.4.5.js"></script>
<script type="text/javascript" src="../vuejs/vue.min.js" ></script>
</head>
<body>
	<div data-role="page">
		<div data-role="header" data-position="fixed" data-tap-toggle="false">
			<a href="#" onclick="back()"
				class="ui-btn ui-icon-back ui-btn-icon-left">返回</a>
			<h1>处理问题</h1>
			<a href="#" onclick="add()" class="ui-btn ui-icon-plus ui-btn-icon-left">新建</a>
		</div>
		<div data-role="main" class="ui-content" id="main">
			<ul id="content" data-role="listview" data-inset="true">
				<li v-for="item in items">
					<a href="#" class="ui-btn ui-icon-eye ui-btn-icon-right" v-on:click="detail(item.d_id)">{{item.pro_id}}</a>
				</li>
			</ul>
			<div data-role="controlgroup" data-type="horizontal" data-mini="true" style="text-align: center;marin: 0 auto;">
				<a herf="#" v-bind:class="{ 'ui-state-disabled' : !previousPageEnable }" class="ui-btn ui-corner-all ui-icon-arrow-l ui-btn-icon-left" onclick="previousPage()">前一页</a>
				<a herf="#" class="ui-btn ui-corner-all ui-icon-refresh ui-btn-icon-left" onclick="refresh()">刷新</a>
				<a herf="#" v-bind:class="{ 'ui-state-disabled' : !nextPageEnable }" class="ui-btn ui-corner-all ui-icon-arrow-r ui-btn-icon-right" onclick="nextPage()">后一页</a>
			</div>
		</div>
		<div style="text-align: center;" data-role="footer"
			data-position="fixed" data-tap-toggle="false">
			<div data-role="controlgroup" data-type="horizontal">
				<a href="#" onclick="gotomain('#page_company')"	class="ui-btn ui-icon-bullets ui-btn-icon-left">企业</a>
				<a href="#" onclick="gotomain('#page_inspect')" class="ui-btn ui-icon-edit ui-btn-icon-left">巡查</a>
				<a href="#"	onclick="gotomain('#page_case')" class="ui-btn ui-icon-calendar ui-btn-icon-left">案件</a>
				<a href="#"	onclick="gotomain('#page_law')"	class="ui-btn ui-icon-tag ui-btn-icon-left">法律</a>
				<a href="#" onclick="gotomain('#page_system')" class="ui-btn ui-icon-gear ui-btn-icon-left">系统</a>
			</div>
		</div>
	</div>
</body>
<script>
	var content = new Vue({
		el: "#main",
		data: {
			items: [],
			pageIndex: 0,
			total: 0
		},
		computed: {
			previousPageEnable: function() {
				return this.pageIndex > 0
			},
			nextPageEnable: function() {
				return this.pageIndex < Math.floor(this.total / 10)
			}
		}
	});
	$(document).ready(function() {
		showLoader();
	});
	function back() {
		window.location = "../company/main.html#page_inspect";
	}
	function gotomain(name) {
		window.location = "../company/main.html" + name;
	}
	//获取所有项目名称
	function showLoader() {
		$.ajax({
			type : "POST",
			url : "http://39.106.145.68:8080/huangbaihe/DealProb/query",
			data: {
				page: content.pageIndex,
				rows: 10
			},
			dataType : 'json',
			success : function(json) {
				content.items = json.rows;
				content.total = json.total;
			}
		});
	}
	
	function previousPage() {
		content.pageIndex -= 1;
		showLoader()
	}
	
	function nextPage() {
		content.pageIndex -= 1;
		showLoader();
	}
	
	function refresh() {
		showLoader();
	}

	function detail(index) {
		window.location = "dealproblemdetail.html?index=" + index;
	}
	function add() {
		window.location = "dealproblemadd.html";
	}
</script>
</html>
