<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>黄柏河流域综合执法信息管理系统</title>
<link rel="stylesheet" href="../jquery.mobile-1.4.5/jquery.mobile-1.4.5.css">
<link rel="stylesheet" href="../jquery-mobile-datepicker-wrapper/jquery.mobile.datepicker.css">
<link rel="stylesheet" href="../jquery-mobile-datepicker-wrapper/jquery.mobile.datepicker.theme.css">
<script src="../jquery.mobile-1.4.5/jquery-2.1.4.min.js"></script>
<script src="../jquery.mobile-1.4.5/jquery.mobile-1.4.5.js"></script>
<script src="../jquery.mobile-1.4.5/jquery.ui.datepicker.js"></script>
<script src="../jquery-mobile-datepicker-wrapper/jquery.mobile.datepicker.js"></script>
<script type="text/javascript" src="../vuejs/vue.min.js" ></script>
<script src="../datejs/date-zh-CN.js"></script> 
<style type="text/css">
.ui-field-contain {
	border-bottom-width: 0px;
}
</style>
</head>
<body>
<div data-role="page">
	<div data-role="header" data-position="fixed" data-tap-toggle="false">
        <a href="#" onclick="back()" class="ui-btn ui-icon-back ui-btn-icon-left">返回</a>
        <h1>新建处理记录</h1>
    </div>
    <div id="main" data-role="main" class="ui-content">
    	<h4>处理记录编号： {{ form.did }}</h4>
    	<form action="#">
            <div class="ui-field-contain">
                <label for="pid">问题编号</label>
                <input type="text" name="pidte" id="pid" v-model="form.pid">
            </div>
            <div class="ui-field-contain">
                <label for="content">督导情况</label>
                <textarea name="contentntent" id="content" v-model="form.content"></textarea>
            </div>
            <div class="ui-field-contain">
                <label for="result">处理结果</label>
                <textarea name="result" id="result" v-model="form.result"></textarea>
            </div>
            <div class="ui-field-contain">
                <label for="person">负责人</label>
                <input type="text" name="person" id="person" v-model="form.person">
            </div>
            <div class="ui-field-contain">
                <label for="date">完成时间</label>
                <input type="date" name="date" id="date" v-model="form.date">
            </div>
        </form>
        <div data-role="controlgroup" data-type="horizontal" data-mini="true" style="text-align: center; margin: 0 auto;">
            <a href="#" data-icon="check" class="ui-btn ui-icon-check ui-btn-icon-left" v-on:click="submit()">提交</a>
            <a href="#" data-icon="delete" class="ui-btn ui-icon-delete ui-btn-icon-left" v-on:click="clean()">清空</a>
        </div>
        <div class="ui-content" id="submit-message" data-role="popup">
        	<a class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right" href="#" data-rel="back">Close</a>
        	<p>{{ submit_status }}</p>
        </div>
    </div>
    <div style="text-align: center;" data-role="footer" data-position="fixed" data-tap-toggle="false">
        <div data-role="controlgroup" data-type="horizontal">
			<a href="#" onclick="gotomain('#page_company')"	class="ui-btn ui-icon-bullets ui-btn-icon-left">企业</a>
			<a href="#" onclick="gotomain('#page_inspect')" class="ui-btn ui-icon-edit ui-btn-icon-left">巡查</a>
			<a href="#"	onclick="gotomain('#page_case')" class="ui-btn ui-icon-calendar ui-btn-icon-left">案件</a>
			<a href="#"	onclick="gotomain('#page_law')"	class="ui-btn ui-icon-tag ui-btn-icon-left">法律</a>
			<a href="#" onclick="gotomain('#page_system')" class="ui-btn ui-icon-gear ui-btn-icon-left">系统</a>
		</div>
    </div>
</div>
<script type="text/javascript">
	var content = new Vue({
		el: "#main",
		data: {
			form: {
				did: "cl-" + new Date().toString("yyyyMMddHHmmss"),
				pid: "",
				content: "",
				result: "",
				person: "",
				date: Date.today().toString("yyyy-MM-dd"),
			},
			submit_status: ""
		}
	})
	function back() {
		window.location = "daily.htmll";
	}
	
	function submit() {
		$.ajax({
			type: "post",
			url: "http://39.106.145.68.8080/huangbaihe/DealProb/save",
			data: content.form,
			success: function() {
				content.submit_status = "提交成功";
				$("#submit-message").popup("open");
				setTimeout(function() {
					$("#submit-message").popup("close");
				}, 5000)
			},
			error: function() {
				content.submit_status = "提交失败";
				$("#submit-message").popup("open");
				setTimeout(function() {
					$("#submit-message").popup("close");
				}, 5000)
			}
		});
	}
	
	function clean() {
		for (key in content.form) {
			if (content.form.hasOwnProperty(key)) {
				content.form[key] = ""
			}
		}
	}
</script>
</body>
</html>